
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SVC_HUBBLE"."VW_CTD_MAPPING" ("R_OBJECT_ID", "OBJECT_NAME", "R_MODIFY_DATE", "IS_ACTIVE", "INFORMATION_CLASSIFICATION", "SECURITY_DOMAIN", "BUSINESS_UNIT", "CONCEPT", "CTD_MAPPING_R_OBJECT_ID", "MARKET_NAME", "CLASSIFICATION_ARTIFACT", "CLASSIFICATION_DOMAIN", "CLASSIFICATION_GROUP", "CLASSIFICATION_SUBGROUP", "ROSTER_REGION", "IS_EEA", "IS_EU") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT A.R_OBJECT_ID,
           B.OBJECT_NAME,
           B.R_MODIFY_DATE,
           B.IS_ACTIVE,
           B.INFORMATION_CLASSIFICATION,
           B.SECURITY_DOMAIN,
           B.BUSINESS_UNIT,
           B.CONCEPT,
           C.CTD_MAPPING_R_OBJECT_ID,
           C.MARKET_NAME,
           C.CLASSIFICATION_ARTIFACT,
           C.CLASSIFICATION_DOMAIN,
           C.CLASSIFICATION_GROUP,
           C.CLASSIFICATION_SUBGROUP,
           M.ROSTER_REGION,(SELECT MAX (IS_EEA)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = c.MARKET_NAME)
                 IS_EEA,(SELECT MAX (IS_EU)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = c.MARKET_NAME)
               IS_EU
      FROM COSMOSDBEXPORT.CTD_MAPPING  A
           LEFT JOIN COSMOSDBEXPORT.CTD_MAPPING_R C
               ON A.R_OBJECT_ID = C.CTD_MAPPING_R_OBJECT_ID
           INNER JOIN COSMOSDBEXPORT.OBJECT B
               ON A.R_OBJECT_ID = B.R_OBJECT_ID
            LEFT JOIN COSMOSDBEXPORT.MARKET M on c.market_name = M.ISO_COUNTRY_NAME;
