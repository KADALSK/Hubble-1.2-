
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SVC_HUBBLE"."VW_TRADE_NAME" ("R_OBJECT_ID", "PRODUCT_FAMILY", "PARENT_OBJECT_UID", "PARENT_TYPE", "MARKET_NAME", "R_CREATION_DATE", "IS_ACTIVE", "BUSINESS_UNIT", "R_MODIFY_DATE", "SECURITY_DOMAIN", "INFORMATION_CLASSIFICATION", "TRADE_NAME", "ROSTER_REGION", "IS_EEA", "IS_EU") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT A.R_OBJECT_ID,
           A.PARENT_OBJECT_NAME     AS Product_Family,
           A.PARENT_OBJECT_UID,
           A.PARENT_TYPE,
           B.MARKET_NAME,
           C.R_CREATION_DATE,
           C.IS_ACTIVE,
           C.BUSINESS_UNIT,
           C.R_MODIFY_DATE,
           C.SECURITY_DOMAIN,
           C.INFORMATION_CLASSIFICATION,
           c.object_name            AS Trade_name,
           M.ROSTER_REGION,(SELECT MAX (IS_EEA)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
                 IS_EEA,(SELECT MAX (IS_EU)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
               IS_EU
      FROM COSMOSDBEXPORT.TRADE_NAME  A
           LEFT JOIN COSMOSDBEXPORT.TRADE_NAME_R B
               ON A.R_OBJECT_ID = B.TRADE_NAME_R_OBJECT_ID
           INNER JOIN COSMOSDBEXPORT.OBJECT C
               ON A.R_OBJECT_ID = C.R_OBJECT_ID
LEFT JOIN COSMOSDBEXPORT.MARKET M on b.market_name = M.ISO_COUNTRY_NAME;
