
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SVC_HUBBLE"."VW_PRODUCT_VOCABULARIES" ("R_OBJECT_ID", "OBJECT_NAME", "R_MODIFY_DATE", "R_CREATION_DATE", "BUSINESS_UNIT", "CERTIFICATION_STATUS", "CLASSIFICATION_DOMAIN", "CLASSIFICATION_GROUP", "CLASSIFICATION_SUBGROUP", "CLASSIFICATION_ARTIFACT", "CONCEPT", "INFORMATION_CLASSIFICATION", "IS_ACTIVE", "RISK_CLASSIFICATION_NAME", "SECURITY_DOMAIN", "MANUFACTURER_NAME", "MARKET_NAME", "LINKED_PRODUCT_FAMILY_NAME", "PRODUCT_FAMILY_NAME", "INDICATION_NAME", "DRUG_SUBSTANCE_NAME", "GLOBAL_PRODUCT_NAME", "ROSTER_REGION", "IS_EEA", "IS_EU") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT A.R_OBJECT_ID,
           A.OBJECT_NAME,
           A.R_MODIFY_DATE,
           A.R_CREATION_DATE,
           A.BUSINESS_UNIT,
           A.CERTIFICATION_STATUS,
           A.CLASSIFICATION_DOMAIN,
           A.CLASSIFICATION_GROUP,
           A.CLASSIFICATION_SUBGROUP,
           A.CLASSIFICATION_ARTIFACT,
           A.CONCEPT,
           INFORMATION_CLASSIFICATION,
           A.IS_ACTIVE,
           A.RISK_CLASSIFICATION_NAME,
           A.SECURITY_DOMAIN,
           B.MANUFACTURER_NAME,
           B.MARKET_NAME,
           B.LINKED_PRODUCT_FAMILY_NAME,
           B.PRODUCT_FAMILY_NAME,
           B.INDICATION_NAME,
           B.DRUG_SUBSTANCE_NAME,
           B.GLOBAL_PRODUCT_NAME,
           m.roster_region,
           (SELECT MAX (IS_EEA)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
                 IS_EEA,(SELECT MAX (IS_EU)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
               IS_EU
      FROM COSMOSDBEXPORT.PRODUCT  A
           LEFT JOIN COSMOSDBEXPORT.PRODUCT_R B
               ON A.R_OBJECT_ID = B.PRODUCT_R_OBJECT_ID
               left join COSMOSDBEXPORT.market m on  b.market_name = m.iso_country_name;
