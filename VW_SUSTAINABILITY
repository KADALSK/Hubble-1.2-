
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SVC_HUBBLE"."VW_SUSTAINABILITY" ("R_OBJECT_ID", "INDICATION_NAME", "INDICATION_UID", "REGULATORY_ACTIVITY_NAME", "MARKET_NAME", "PRODUCT_FAMILY_NAME", "DATE_OF_FIRST_AUTHORISATION", "AUTHORISATION_STATUS_DATE", "AUTHORIZATION_NUMBER", "CLASSIFICATION_GROUP", "CLASSIFICATION_SUBGROUP", "CLASSIFICATION_ARTIFACT", "CLASSIFICATION_DOMAIN", "SPECIAL_DESIGNATION", "SPECIAL_DESIGNATION_DATE", "BUSINESS_UNIT", "APPLICATION_NAME", "AUTHORISATION_TYPE", "AUTHORISATION_STATUS", "MEDICINAL_PRODUCT_NAME", "PACKAGED_PRODUCT_NAME", "SECURITY_DOMAIN", "INFORMATION_CLASSIFICATION", "IS_ACTIVE", "AUTHORISATION_HOLDER_NAME", "INDICATION_STATUS_DATE", "INDICATION_STATUS", "VALIDITY_PERIOD_START", "VALIDITY_PERIOD_END", "CONCEPT", "CONFIG_UID", "R_MODIFY_DATE", "R_MODIFIER", "HISTORIC_NAME_VALUE", "NAME_VALUE_CHANGE_DATE", "ROSTER_REGION", "IS_EEA", "IS_EU") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT DISTINCT A.r_object_id,
                    B.INDICATION_NAME,
                    B.INDICATION_UID,
                    B.REGULATORY_ACTIVITY_NAME,
                    A.MARKET_NAME,
                    A.PRODUCT_FAMILY_NAME,
                    A.DATE_OF_FIRST_AUTHORISATION,
                    A.AUTHORISATION_STATUS_DATE,
                    E.OBJECT_NAME       AS AUTHORIZATION_NUMBER,
                    SM.CLASSIFICATION_GROUP,
                    SM.CLASSIFICATION_SUBGROUP,
                    SM.CLASSIFICATION_ARTIFACT,
                    SM.CLASSIFICATION_DOMAIN,
                    B.SPECIAL_DESIGNATION,
                    B.SPECIAL_DESIGNATION_DATE,
                    E.BUSINESS_UNIT,
                    F.OBJECT_NAME       AS APPLICATION_NAME,
                    A.AUTHORISATION_TYPE,
                    A.AUTHORISATION_STATUS,
                    B.MEDICINAL_PRODUCT_NAME,
                    B.PACKAGED_PRODUCT_NAME,
                    E.SECURITY_DOMAIN,
                    E.INFORMATION_CLASSIFICATION,
                    E.IS_ACTIVE,
                    A.AUTHORISATION_HOLDER_NAME,
                    --A.AUTHORISATION_STATUS_DATE AS INDICATION_STATUS_DATE,
                    B.INDICATION_STATUS_DATE,
                    B.INDICATION_STATUS,
                    ---NULL AS INDICATION_STATUS,
                    A.VALIDITY_PERIOD_START,
                    A.VALIDITY_PERIOD_END,
                    E.CONCEPT,
                    E.CONFIG_UID,
                    E.R_MODIFY_DATE,
                    E.R_MODIFIER,
                    E.OBJECT_NAME       AS HISTORIC_NAME_VALUE,
                    E.R_MODIFY_DATE     AS NAME_VALUE_CHANGE_DATE,
                    M.ROSTER_REGION,(SELECT MAX (IS_EEA)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = a.MARKET_NAME)
                 IS_EEA,(SELECT MAX (IS_EU)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = a.MARKET_NAME)
               IS_EU
      FROM COSMOSDBEXPORT.PRODUCT_AUTHORISATION  A
           INNER JOIN COSMOSDBEXPORT.PRODUCT_AUTHORISATION_R B
               ON A.R_OBJECT_ID = B.PRODUCT_AUTHORISATION_R_OBJECT_ID
           INNER JOIN COSMOSDBEXPORT.OBJECT E
               ON E.R_OBJECT_ID = A.R_OBJECT_ID
           INNER JOIN COSMOSDBEXPORT.SUBMISSION_MANAGER SM
               ON SM.CONFIG_UID = B.REGULATORY_ACTIVITY_UID
           INNER JOIN COSMOSDBEXPORT.OBJECT F
               ON A.REGULATORY_APPLICATION_UID = F.CONFIG_UID
                LEFT JOIN COSMOSDBEXPORT.MARKET M on a.market_name = M.ISO_COUNTRY_NAME;
