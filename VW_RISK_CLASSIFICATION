
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SVC_HUBBLE"."VW_RISK_CLASSIFICATION" ("R_OBJECT_ID", "RISK_CLASSIFICATION", "MARKET_NAME", "IS_ACTIVE", "BUSINESS_UNIT", "R_MODIFY_DATE", "SECURITY_DOMAIN", "INFORMATION_CLASSIFICATION", "CONCEPT", "ROSTER_REGION", "IS_EEA", "IS_EU") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT A.R_OBJECT_ID,
           C.OBJECT_NAME     AS RISK_CLASSIFICATION,
           B.MARKET_NAME,
           C.IS_ACTIVE,
           C.BUSINESS_UNIT,
           C.R_MODIFY_DATE,
           C.SECURITY_DOMAIN,
           C.INFORMATION_CLASSIFICATION,
           C.CONCEPT,
           M.ROSTER_REGION,(SELECT MAX (IS_EEA)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
                 IS_EEA,(SELECT MAX (IS_EU)
                FROM COSMOSDBEXPORT.MARKET
               WHERE ISO_COUNTRY_NAME = b.MARKET_NAME)
               IS_EU
      FROM COSMOSDBEXPORT.RISK_CLASSIFICATION  A
           LEFT JOIN COSMOSDBEXPORT.RISK_CLASSIFICATION_R B
               ON A.R_OBJECT_ID = B.RISK_CLASSIFICATION_R_OBJECT_ID
           INNER JOIN COSMOSDBEXPORT.OBJECT C
               ON A.R_OBJECT_ID = C.R_OBJECT_ID
            LEFT JOIN COSMOSDBEXPORT.MARKET M on b.market_name = M.ISO_COUNTRY_NAME;
